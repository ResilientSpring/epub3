# Tools to parse ABBYY XML into EPUB3

This module transforms ABBYY XML documents, generated by ABBYY FineReader 10,
into primitively accessible ePub 3. The code is optimized for ABBYY XML
documents created by the Internet Archive, though it may work for other ABBYY
XML as well. 

Accessibility is inherently limited by the input ABBY FineReader documents. If
they are marked up with headings and other semantic markup, that structure
will be incorporated into the ePub.

There is currently no functionality for image description.

## Requirements

* Python 3

## Usage

From with a Python program:

```python
from abbyy_to_epub3 import create_epub
create_epub.craft_epub('docname') # See *Assumptions* below.
```

From the shell:

```bash
 python bin/create_epub.py styleliterarymet00cadb

```

## Installation

This package can be installed on your local system. From the directory
containing setup.py:

```bash
pip install -r requirements.txt
python setup.py develop
pip install .
```
### Assumptions

This application assumes you are working in a directory which contains a
subdirectory for the document and a specific set of files. If the document is
named `docname`, the directory structure assumed is:

```bash
docname/
    docname_abbyy.gz
    docname_meta.xml
    docname_jp2.zip
```

* `docname_abbyy.gz` unzips to `docname_abbyy`, an XML file generated by
  ABBYY.
* `docname_jp2.zip` unzips to a directory called `docname_jp2`, which includes
  a number of documents in the format `docname_####.jp2`. 
** `docname_0000.jp2` is scanner calibration.
** `docname_0001.jp2` is the cover image and the first image reference in the
ABBYY.

## TODO

1. Unit tests
1. Logging
1. Exception handling
1. Adding nesting to the navigation
1. Extracting images with some alternative text of some kind
1. Handling more of the limited ABBYY semantic markup
1. Running Epubcheck
1. Enable running on multiple documents at once
1. Put some commonsense error checking on text marked up with "Heading" to 
ignore that markup if the text element is more than a certain length.
1. Verify that headings close out correctly in the code.
1. Verify that it does RTL langs correctly
1. Accessibility testing
1. Ignore repeated separator elements
